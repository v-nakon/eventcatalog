document.addEventListener("DOMContentLoaded",(function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),n=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let a=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),a.unobserve(t)}}))}));e.forEach((function(e){a.observe(e)}));let o=new IntersectionObserver((function(e,t){e.forEach((function(e){e.isIntersecting&&(e.target.classList.add("visible"),o.unobserve(e.target))}))}));t.forEach((function(e){o.observe(e)}));let c=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",c.unobserve(t)}}))}));n.forEach((function(e){c.observe(e)}))}else e.forEach((function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset})),t.forEach((function(e){e.classList.add("visible")})),n.forEach((function(e){e.style.backgroundImage="url("+e.dataset.bg+")"}))}));var searchName=document.querySelector("#event_name"),searchLocation=document.querySelector("#city"),modalNotFound=document.querySelector(".container_modal_notfound"),closeModalNotfound=document.querySelector(".close_modal_notfound"),datepickerStart="",datepickerEnd="";getCities("city"),closeModalNotfound.addEventListener("click",(function(){modalNotFound.style.display="none",document.location.href="/"}));let btnSearch=document.querySelector(".btn_search");function viewEvent(e){console.log("ID",e),console.log(window.location.href);let t=window.location.href+"event-page.html?id="+e;window.open(t)}function createEventCard(e){let t='\n\t<div class="event_card_content">\n\t  <img src="https://eventafisha.com/storage/'+e.images+'" alt="" class="event_card_img">\n\t  <div class="event_card_title">'+e.title+'</div>\n\t  <div class="event_card_tag">'+e.category.title+'</div>\n\t  <div class="event_card_date">'+new Date(e.start_date).toLocaleDateString()+'</div>\n\t  <div class="event_card_location">'+e.address+'</div>\n\t  <input class="event_card_btn" type="submit" value="View event" onclick="viewEvent('+e.id+')">\n\t</div>',n=document.querySelector(".container_events"),a=document.createElement("li");a.className="event_card",a.innerHTML=t,n.append(a)}function getCities(e){axios.get("https://eventafisha.com/api/v1/cities").then((function(t){for(let n in t.data)addOptionSelect(t.data[n],e)})).catch((function(e){console.log(e)})).then((function(){}))}function addOptionSelect(e,t){let n=document.getElementById(t),a=document.createElement("option");a.value=e.id,a.innerHTML=e.title,n.add(a)}function searchEvent(e,t,n,a){paginationAjax("#pagination",document.getElementById(e).value,document.getElementById(t).value,n,a,"")}function removeEventList(){for(var e=document.querySelector(".container_events");e.firstChild;)e.removeChild(e.firstChild)}function checkSearchParam(e,t,n,a,o){let c="https://eventafisha.com/api/v1/events?";return""!==e&&(c+="&title="+e),""!==t&&(c+="&city_id="+t),""!==n&&(c+="&date_start="+n),""!==a&&(c+="&date_end="+a),""!==o&&(c+="&category_id="+o),c}function paginationAjax(e,t,n,a,o,c){let i=checkSearchParam(t,n,a,o,c);$(e).pagination({dataSource:i,locator:"data",totalNumberLocator:function(e){return console.log("test",e.total),e.total},pageSize:20,showPageNumbers:!0,showPrevious:!0,showNext:!0,showFirstOnEllipsisShow:!0,showLastOnEllipsisShow:!0,className:"paginationjs-theme paginationjs-small",alias:{pageNumber:"page",pageSize:"limit"},ajax:{},callback:function(e,t){window.console&&console.log(22,e,t.pageNumber),console.log(t.pageNumber),console.log("res len",e.length),0===e.length?modalNotFound.style.display="block":(removeEventList(),$.each(e,(function(e,t){createEventCard(t)}))),searchName.value="",searchLocation.value="",datepickerStart="",datepickerEnd=""}})}btnSearch.addEventListener("click",()=>searchEvent("event_name","city",datepickerStart,datepickerEnd)),$((function(){paginationAjax("#pagination","","","","","")})),$((function(){$(".datepicker-start").datepicker({onSelect:function(e,t){datepickerStart=e},minDate:new Date})})),$((function(){$(".datepicker-end").datepicker({onSelect:function(e,t){datepickerEnd=e},minDate:new Date})}));